<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Introduction to Docker</title>
<meta name="author" content="Marco Pas"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/dist/reveal.css"/>

<link rel="stylesheet" href="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/dist/theme/black.css" id="theme"/>

<link rel="stylesheet" href="./css/custom.css"/>
<link rel="stylesheet" href="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/plugin/highlight/zenburn.css"/>
<meta name="description" content="Introduction to Docker">
</head>
<body>
<div class="reveal">
<div class="slides">

<section>
<section id="slide-org44df29d" data-background="./images/title-slide.jpg" data-background-opacity="0.3">
<h2 id="org44df29d">Introduction to Docker</h2>

</section>
</section>
<section>
<section id="slide-orgf378cbf">
<h2 id="orgf378cbf">Quick inventory</h2>
<ul>
<li>Who has never heared of Docker?</li>
<li>Who has used or is using Docker?</li>

</ul>

</section>
</section>
<section>
<section id="slide-org8f2781d">
<h2 id="org8f2781d">Goals</h2>
<ul>
<li>Learn the basics about Docker
<ul>
<li>Images &amp; containers</li>
<li>Data storage</li>
<li>Application stacks</li>
<li>Docker layers</li>

</ul></li>
<li>Use cases</li>

</ul>

<blockquote>
<p>
If there are questions please do not hesitate to ask them!!
</p>
</blockquote>

</section>
</section>
<section>
<section id="slide-org3526bfc">
<h2 id="org3526bfc">What is Docker?</h2>
<p>
A software <b><span class="underline">containerisation</span></b> platform
</p>

<blockquote>
<p>
For packaging and running applications!
</p>
</blockquote>

</section>
<section id="slide-org8e6527b">
<h3 id="org8e6527b">What is Docker trying to solve?</h3>
<p>
The famous “it works on my machine” headache!
</p>


<div id="org37ff13d" class="figure">
<p><img src="./images/docker-challenge.png" alt="docker-challenge.png" />
</p>
</div>

</section>
<section id="slide-org457dbdd">
<h3 id="org457dbdd">Docker solution</h3>
<p>
Create reusable platform independent packages
</p>


<div id="org3867f3b" class="figure">
<p><img src="./images/docker-challenge-solution.png" alt="docker-challenge-solution.png" />
</p>
</div>

</section>
<section id="slide-orgf88a700">
<h3 id="orgf88a700">Docker vocabulary</h3>
<ul>
<li><b><span class="underline">Docker image</span></b>
<ul>
<li>Blueprint of an application</li>

</ul></li>
<li class="fragment roll-in"><b><span class="underline">Docker container</span></b>
<ul>
<li>Instance of a started image</li>

</ul></li>
<li class="fragment roll-in"><b><span class="underline">Docker engine</span></b>
<ul>
<li>Creates, ships and runs Docker containers</li>

</ul></li>
<li class="fragment roll-in"><b><span class="underline">Docker registry</span></b>
<ul>
<li>Storage for images</li>

</ul></li>

</ul>

</section>
<section id="slide-orgcead8b3">
<h3 id="orgcead8b3">Virtual machine vs container</h3>

<div id="org01f6145" class="figure">
<p><img src="./images/containers-vs-virtual-machines.jpg" alt="containers-vs-virtual-machines.jpg" />
</p>
</div>

</section>
<section id="slide-orgd3e9e13">
<h3 id="orgd3e9e13">Docker architecture</h3>

<div id="orge06e8ad" class="figure">
<p><img src="./images/docker-architecture.png" alt="docker-architecture.png" />
</p>
</div>

</section>
<section id="slide-org1162f2d">
<h3 id="org1162f2d">Docker use cases</h3>
<ol>
<li>Application isolation</li>
<li>Developer productivity</li>
<li>Rapid deployment</li>
<li>Simplifying configuration</li>
<li>Code pipeline management</li>

</ol>

</section>
</section>
<section>
<section id="slide-orga9f24cb">
<h2 id="orga9f24cb">Docker images and containers</h2>
<ul>
<li>Image
<ul>
<li>An immutable template for containers</li>
<li>Can be created, pulled and pushed towards public and private registries
<ul>
<li>e.g. <a href="https://hub.docker.com/search?q=&amp;type=image">Docker Hub</a></li>

</ul></li>

</ul></li>
<li class="fragment roll-in">Container
<ul>
<li>Instance of an image</li>
<li>Can be started, stopped, restarted</li>

</ul></li>

</ul>

</section>
<section id="slide-orgfa56b2a">
<h3 id="orgfa56b2a">Reuse existing images</h3>
<div class="org-src-container">

<pre><code class="bash" ># search for image 'hello' in registry
$ docker search hello
$ docker search --filter=stars=3 --no-trunc hello
$ docker search --filter=is-official=true --no-trunc hello

# docker pull &lt;registry&gt;:&lt;port&gt;/&lt;image&gt;:&lt;tag&gt;
$ docker pull hello-world \n
$ docker pull ubuntu        'default latest'
$ docker pull ubuntu:latest 'equal to previous'
$ docker pull ubuntu:14.0.4 'with tag'

# list images on local system
$ docker image ls

# run an image and create a container
$ docker run hello-world
$ docker run ubuntu echo "hello world"
</code></pre>
</div>

</section>
<section id="slide-org2dd0054" data-background="./images/demo.jpg" data-background-opacity="0.3">
<h3 id="org2dd0054">Demo</h3>
<ul>
<li>Search for a Docker image (cli / dockerhub)</li>
<li>Download Docker image</li>
<li>Run hello-world</li>
<li>Run ubuntu</li>
<li>Get some system information</li>

</ul>

<aside class="notes">
<p>
$ docker search hello
</p>

<p>
$ docker search &#x2013;filter=is-official=true &#x2013;no-trunc hello
</p>

<p>
$ docker pull hello-world
</p>

<p>
$ docker run hello-world
</p>

<p>
$ docker run ubuntu echo &ldquo;hello from ubuntu&rdquo;
</p>

<p>
$ docker ps
</p>

<p>
$ docker ps -a
</p>

</aside>

</section>
<section id="slide-org75cff82">
<h3 id="org75cff82">Create your own images</h3>
<p>
<b><span class="underline">Dockerfile</span></b>
</p>

<p>
Each Dockerfile is a script (DSL), composed of various commands and arguments to perform actions on a base image in order to create a new one.
</p>


<div id="orgdfad1d2" class="figure">
<p><img src="./images/from-dockerfile-to-container.png" alt="from-dockerfile-to-container.png" width="600px" />
</p>
</div>

</section>
<section id="slide-org8b5a986">
<h3 id="org8b5a986">Dockerfile commands</h3>

<div id="org7bc973a" class="figure">
<p><img src="./images/dockerfile-commands.png" alt="dockerfile-commands.png" />
</p>
</div>

</section>
<section id="slide-orge791846">
<h3 id="orge791846">Dockerfile example 1</h3>
<div class="org-src-container">

<pre><code class="dockerfile" ># file: Dockerfile
# select a base image
FROM tomcat:10.0.0

# add a file to the image
COPY index.html /usr/local/tomcat/webapps/ROOT/index.html
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="shell" ># build the image
$ docker build --file Dockerfile --tag tomcat:test .
# equal to (when in the Dockerfile folder!):
# -&gt; docker build -t tomcat-test .
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="shell" ># run container and publish ports
$ docker run --publish 8080:8080 tomcat:test
# equal to:
# -&gt; docker run -p 8080:8080 tomcat:test
</code></pre>
</div>

</section>
<section id="slide-org79af2d0">
<h3 id="org79af2d0">Dockerfile example 2</h3>
<div class="org-src-container">

<pre><code class="dockerfile" ># select a base image
FROM azul/zulu-openjdk:11

# add a file to the image
ADD service.jar

# expose a port
EXPOSE 8080

# run the application
CMD ["java","-jar","/service.jar"]
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="shell" ># build the image
$ docker build --file Dockerfile --tag my-app:0.1 .
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="shell" ># run container and publish ports
$ docker run --publish 80:8080 my-app:0.1
</code></pre>
</div>

<div class="org-src-container">

<pre><code class="shell" ># ship/push the image
$ docker push my-app:0.1
</code></pre>
</div>

</section>
<section id="slide-orga189743" data-background="./images/demo.jpg" data-background-opacity="0.3">
<h3 id="orga189743">Demo</h3>
<ul>
<li>Build docker image</li>
<li>Run docker image (results in a container)</li>
<li>Push the docker image</li>

</ul>

<aside class="notes">
<p>
$ docker build -t marcopas/docker-intro:test .
</p>

<p>
$ docker run -p 8080:8080 marcopas/docker-intro:test
</p>

<p>
$ docker ps
</p>

<p>
$ docker push marcopas/docker-intro:test
</p>

</aside>

</section>
<section id="slide-org6fadf3f">
<h3 id="org6fadf3f">Information &amp; cleanup</h3>
<div class="org-src-container">

<pre><code class="bash" ># show running containers
$ docker ps

# show running/stopped containers
$ docker ps -a

# cleanup
$ docker system prune -a
$ docker container prune
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org3ba728b">
<h2 id="org3ba728b">Docker data storage</h2>
<ul>
<li>In-container (bad idea!)</li>
<li>Bind mounts (mount to local file system)</li>
<li>Volumes (data is managed by docker)</li>

</ul>

<div class="org-src-container">

<pre><code class="bash" ># start interactive docker container, mount local folder 
$ docker run -it --rm -v $(pwd):/my-data openjdk:11-jdk bash

# create volume
$ docker volume create my-volume

# list volumes
$ docker volume ls

# start docker container and use docker volume
$ docker run -it --rm -v my-volume:/my-data alpine sh
</code></pre>
</div>

</section>
<section id="slide-org68a7597" data-background="./images/demo.jpg" data-background-opacity="0.3">
<h3 id="org68a7597">Demo</h3>
<ul>
<li>Use local filesystem mount</li>
<li>Use Docker volumes</li>

</ul>

<aside class="notes">
<p>
Compile a java class on different JDK versions
</p>

<p>
$ docker run -it &#x2013;rm -v $(pwd):/my-data openjdk:11-jdk bash
</p>

<p>
$ docker run -it &#x2013;rm -v $(pwd):/my-data openjdk:14-jdk bash
</p>

<p>
$ docker run -it &#x2013;rm -v $(pwd):/my-data alpine sh
</p>

<p>
$ touch this-is-a-new file
</p>

<p>
Show that file is created on local file system
</p>

<p>
$ docker volume create my-volume
</p>

<p>
$ docker volume ls
</p>

<p>
$ docker run -it &#x2013;rm -v my-volume:/my-data alpine sh
</p>

<p>
$ docker run -it &#x2013;rm -v my-volume:/my-data alpine sh
</p>

</aside>

</section>
</section>
<section>
<section id="slide-org9e08774">
<h2 id="org9e08774">Docker compose</h2>
<p>
Managing multiple containers via the commandline is cumbersome! So we we need a way to
easily handle multiple containers at once.
</p>

</section>
<section id="slide-org980992c">
<h3 id="org980992c">Without / With compose</h3>
<ul>
<li>Without compose
<ul>
<li>build and run one container at a time</li>
<li>manually connect containers</li>

</ul></li>
<li>With compose
<ul>
<li>define multi container stack in a file</li>
<li>single command to start entire stack</li>
<li>handles container dependencies</li>

</ul></li>

</ul>

</section>
<section id="slide-orgdb18354">
<h3 id="orgdb18354">3 Steps of compose</h3>
<ol>
<li>Define the services that make your application stack in a Docker compose file</li>

<li>(optional) Define your application environment in a Dockerfile (compose build!)</li>

<li>Run the CLI:</li>

</ol>

<div class="org-src-container">

<pre><code class="shell" >$ docker-compose up
</code></pre>
</div>

</section>
<section id="slide-orgec20e5e">
<h3 id="orgec20e5e">Compose example</h3>
<div class="org-src-container">

<pre><code class="dockerfile" >version: '3.9'

services:
  db:
    image: mysql:5.7
    restart: always
    # some code omitted!!
    volumes:
      - db_data:/var/lib/mysql
  wordpress:
    image: wordpress:latest
    ports:
      - "8000:80"
    restart: always
    environment:
      # some code omitted!!
      WORDPRESS_DB_HOST: db:3306
    depends_on:
      - db

volumes:
  db_data:
</code></pre>
</div>

</section>
<section id="slide-org3923270">
<h3 id="org3923270">Compose commands</h3>
<div class="org-src-container">

<pre><code class="shell" >$ docker-compose up
$ docker-compose up -d
$ docker-compose down
$ docker-compose down --volumes
</code></pre>
</div>

</section>
<section id="slide-org7e2079f" data-background="./images/demo.jpg" data-background-opacity="0.3">
<h3 id="org7e2079f">Demo</h3>
<ul>
<li>Start full stack using Docker Compose
<ul>
<li>Wordpress</li>
<li>MySql with admin tooling</li>
<li>Using Compose to build</li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orge4cd8b3">
<h2 id="orge4cd8b3">Docker layers</h2>
<ul>
<li>Each <code>build</code> command generates a layer</li>
<li>A complete <code>build</code> creates a SINGLE image</li>

</ul>


<div id="org0954449" class="figure">
<p><img src="./images/docker-image-layers.png" alt="docker-image-layers.png" height="300px" />
</p>
</div>

</section>
<section id="slide-org4665378">
<h3 id="org4665378">Problems with Docker build</h3>

<div id="orgd62acb8" class="figure">
<p><img src="./images/problems-with-docker-build.png" alt="problems-with-docker-build.png" />
</p>
</div>

</section>
<section id="slide-org3f44cbc">
<h3 id="org3f44cbc">Multistage build</h3>
<ul>
<li>Build the application</li>
<li>Perform static code analysis</li>
<li>Run unit tests</li>
<li>Run integration tests</li>
<li>Package application</li>

</ul>

</section>
<section id="slide-org7a64387">
<h3 id="org7a64387">Do we have a problem?</h3>
<div class="org-src-container">

<pre><code class="dockerfile" >FROM openjdk:11-jdk
WORKDIR /opt/app/src
# Copies in our code and compiles
COPY /src/*.java ./
RUN javac *.java

# Perform static code analysis
RUN apt-get install sonar-scanner
RUN sonar-scanner -Dsonar.host.url=http://host.docker.internal:9000 -Dsonar.projectKey=helloworld -Dsonar.sources=.
RUN apt-get remove sonar-scanner

# Run unit tests
# Run integration tests

# Create application
RUN rm -rf /src/*.java
CMD java HelloWorld
</code></pre>
</div>

</section>
<section id="slide-org7453988">
<h3 id="org7453988">Docker builder pattern</h3>
<ul>
<li>2 Dockerfiles
<ul>
<li>1st for build tools</li>
<li>2nd for runtime</li>

</ul></li>
<li>Drawbacks
<ul>
<li>2 Dockerfiles</li>
<li>Orchestration needed</li>

</ul></li>

</ul>

</section>
<section id="slide-orgda2f366">
<h3 id="orgda2f366">Docker multistage builds</h3>
<ul>
<li>Single Dockerfile with multiple stages</li>
<li>Same build!! Local and CI</li>

</ul>

</section>
<section>
<div class="org-src-container">

<pre><code class="dockerfile" ># Copies in our code and compiles
FROM openjdk:11-jdk as builder
WORKDIR /opt/app/src
COPY /src/*.java ./
RUN javac *.java

# Perform static code analysis
FROM sonarsource/sonar-scanner-cli as sonarqube
WORKDIR /opt/app/src
COPY --from=builder /opt/app/src ./
RUN sonar-scanner -Dsonar.host.url=http://host.docker.internal:9000 -Dsonar.projectKey=helloworld -Dsonar.sources=.

# Run unit tests
# Run integration tests

# Create application
FROM openjdk:11-jdk as application
WORKDIR /opt/app/src
COPY --from=builder /opt/app/src/*.class ./
CMD java HelloWorld
</code></pre>
</div>

</section>
<section id="slide-orga165d5d" data-background="./images/demo.jpg" data-background-opacity="0.3">
<h3 id="orga165d5d">Demo</h3>
<ul>
<li>Perform multistage build
<ul>
<li>Compile code</li>
<li>Static code analysis</li>
<li>Create image</li>

</ul></li>

</ul>

<aside class="notes">
<p>
Start SonarQube
</p>

<p>
<a href="http://localhost:9000">http://localhost:9000</a>
</p>

<p>
$ docker-compose up -d
</p>

<p>
$ docker run -it &#x2013;rm -v $(pwd):/my-data openjdk:14-jdk bash
</p>

<p>
$ docker run -it &#x2013;rm -v $(pwd):/my-data alpine sh
</p>

<p>
$ touch this-is-a-new file
</p>

<p>
Show that file is created on local file system
</p>

<p>
$ docker volume create my-volume
</p>

<p>
$ docker volume ls
</p>

<p>
$ docker run -it &#x2013;rm -v my-volume:/my-data alpine sh
</p>

<p>
$ docker run -it &#x2013;rm -v my-volume:/my-data alpine sh
</p>

</aside>

</section>
</section>
<section>
<section id="slide-orgcc8764c">
<h2 id="orgcc8764c">As a developer</h2>
<ul>
<li>I need to build my software
<ul>
<li>Use a container</li>

</ul></li>
<li>I need a database or something else&#x2026;
<ul>
<li>dont install local but use a compose file!</li>

</ul></li>
<li>I need to run my software
<ul>
<li>build using docker and run using docker</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgbf48bb1">
<h2 id="orgbf48bb1">More information</h2>
<ul>
<li><a href="https://docker-curriculum.com/">Docker Curriculum</a></li>
<li><a href="https://www.docker.com/">Docker</a></li>
<li><a href="https://hub.docker.com/search?q=&amp;type=image">Docker Hub</a></li>
<li><a href="https://docs.docker.com/compose/gettingstarted/">Get started with Docker Compose</a></li>
<li><a href="https://docs.docker.com/compose/compose-file/">Docker Compose File Format</a></li>
<li><a href="https://github.com/veggiemonk/awesome-docker">Docker Awesome</a></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgfe6f11d">
<h2 id="orgfe6f11d">Questions?</h2>
</section>
</section>
</div>
</div>
<p> Created by Marco Pas. </p>
<script src="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/dist/reveal.js"></script>
<script src="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/plugin/highlight/highlight.js"></script>
<script src="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/plugin/markdown/markdown.js"></script>
<script src="/Users/phnl310301178/.emacs.d/.local/straight/build-27.1/revealjs/plugin/notes/notes.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
hashOneBasedIndex: false,
pdfSeparateFragments: true,

overview: true,

transition: 'linear',
transitionSpeed: 'default',

// Plugins with reveal.js 4.x
plugins: [ RevealHighlight, RevealMarkdown, RevealNotes ],

// Optional libraries used to extend reveal.js
dependencies: [
]

});
</script>
</body>
</html>
